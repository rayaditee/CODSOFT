<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe Game</title>

    <style>
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, yellow, blue);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background 0.5s ease;
        }

        .game-container {
            text-align: center;
            background: rgba(255, 255, 255, 0.9); /* fixed */
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(205, 70, 70, 0.3); /* fixed */
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.85); }
            to { opacity: 1; transform: scale(1); }
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 6px;
            margin: 20px auto;
        }

        .cell {
            background: pink;
            border: 2px solid black;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .cell:hover {
            background: whitesmoke;
            transform: scale(1.04);
        }

        .cell.taken {
            cursor: not-allowed;
        }

        .status {
            margin: 10px 0;
            font-size: 1.1em;
            color: darkred;
        }

        .rematch-btn {
            background: purple;
            color: white;
            border: none;
            padding: 10px 18px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
        }

        .rematch-btn:hover {
            background: violet;
        }

        /* themes */
        .theme-retro { background: linear-gradient(45deg, grey, olive); }
        .theme-future { background: linear-gradient(45deg, magenta, cyan); }
        .theme-nature { background: linear-gradient(45deg, teal, tan); }

        .board.theme-retro .cell { border-color: indianred; }
        .board.theme-future .cell { border-color: indigo; box-shadow: 0 0 8px aquamarine; }
        .board.theme-nature .cell { border-color: maroon; background: coral; }
    </style>
</head>

<body>
<div class="game-container">
    <h1>Tic Tac Toe</h1>
    <div class="status" id="gameStatus">Your turn! Pick a box.</div>
    <div class="board" id="gameBoard"></div>
    <button class="rematch-btn" id="restartBtn">Play Again</button>
</div>

<script>
    // AI ka mood random hota hai ðŸ˜„
    let aiLevel = Math.random();

    let gameBoard = Array(9).fill(null);
    let activePlayer = 'X';
    let isFinished = false;

    const boardDiv = document.getElementById('gameBoard');
    const statusDiv = document.getElementById('gameStatus');
    const restartBtn = document.getElementById('restartBtn');

    function setupBoard() {
        boardDiv.innerHTML = '';

        const themes = ['theme-retro', 'theme-future', 'theme-nature'];
        boardDiv.className = 'board ' + themes[Math.floor(Math.random() * themes.length)];

        for (let i = 0; i < 9; i++) {
            const box = document.createElement('div');
            box.className = 'cell';
            box.dataset.pos = i;
            box.addEventListener('click', onCellClick);
            boardDiv.appendChild(box);
        }
        updateText();
    }

    function onCellClick(e) {
        if (isFinished || activePlayer !== 'X') return;

        const pos = e.target.dataset.pos;
        if (gameBoard[pos]) return;

        placeMove(pos, 'X');

        if (!isFinished) {
            setTimeout(aiMove, 450);
        }
    }

    function placeMove(index, player) {
        gameBoard[index] = player;
        const cell = document.querySelector(`[data-pos="${index}"]`);
        cell.textContent = player;
        cell.classList.add('taken');

        if (checkWin(player)) {
            isFinished = true;
            statusDiv.textContent = player === 'X' ? 'You won! ðŸŽ‰' : 'Computer wins ðŸ˜Ž';
            playTone('win');
            return;
        }

        if (gameBoard.every(val => val)) {
            isFinished = true;
            statusDiv.textContent = 'Match Draw ðŸ¤';
            playTone('draw');
            return;
        }

        activePlayer = player === 'X' ? 'O' : 'X';
        updateText();
    }

    function aiMove() {
        if (isFinished) return;

        const move = smartChoice();
        placeMove(move, 'O');

        const lines = ['Hmm...', 'Your move?', 'Try harder!', 'Interesting ðŸ¤”'];
        statusDiv.textContent += ' ' + lines[Math.floor(Math.random() * lines.length)];
    }

    function smartChoice() {
        if (Math.random() > aiLevel) {
            const free = gameBoard.map((v, i) => v === null ? i : null).filter(v => v !== null);
            return free[Math.floor(Math.random() * free.length)];
        }

        let best = -Infinity;
        let bestIndex;

        for (let i = 0; i < 9; i++) {
            if (!gameBoard[i]) {
                gameBoard[i] = 'O';
                let score = minimax(gameBoard, 0, false);
                gameBoard[i] = null;

                if (score > best) {
                    best = score;
                    bestIndex = i;
                }
            }
        }
        return bestIndex;
    }

    function minimax(board, depth, isMax) {
        if (checkWin('O')) return 10 - depth;
        if (checkWin('X')) return depth - 10;
        if (board.every(v => v)) return 0;

        if (isMax) {
            let maxScore = -Infinity;
            for (let i = 0; i < 9; i++) {
                if (!board[i]) {
                    board[i] = 'O';
                    maxScore = Math.max(maxScore, minimax(board, depth + 1, false));
                    board[i] = null;
                }
            }
            return maxScore;
        } else {
            let minScore = Infinity;
            for (let i = 0; i < 9; i++) {
                if (!board[i]) {
                    board[i] = 'X';
                    minScore = Math.min(minScore, minimax(board, depth + 1, true));
                    board[i] = null;
                }
            }
            return minScore;
        }
    }

    function checkWin(player) {
        const combos = [
            [0,1,2],[3,4,5],[6,7,8],
            [0,3,6],[1,4,7],[2,5,8],
            [0,4,8],[2,4,6]
        ];
        return combos.some(c => c.every(i => gameBoard[i] === player));
    }

    function updateText() {
        statusDiv.textContent =
            activePlayer === 'X' ? 'Your turn! Pick a box.' : 'Computer thinking... ðŸ¤–';
    }

    function playTone(type) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        osc.connect(ctx.destination);
        osc.frequency.value = type === 'win' ? 520 : 440;
        osc.start();
        osc.stop(ctx.currentTime + 0.3);
    }

    restartBtn.addEventListener('click', () => {
        gameBoard = Array(9).fill(null);
        activePlayer = 'X';
        isFinished = false;
        aiLevel = Math.random();
        setupBoard();
    });

    setupBoard();
</script>
</body>
</html>
